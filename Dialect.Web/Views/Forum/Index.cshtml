@using Dialect.Web.ViewModels
@model IEnumerable<Dialect.Model.ForumPost>
@{
    var user = Session["user"] as UserViewModel;
    var forumTitle = string.Empty;
    if (user != null)
    {
        forumTitle = user.UserForumName;
    }
}
<div style="margin: 20px;margin-left: 0; font-size: 16px;">
 @Html.ActionLink("发帖", "NewPost", "Forum")   
</div>

<div class="posts-wrap">
    @if (Model.Any())
    {
        foreach (var item in Model)
        {
            if (string.IsNullOrEmpty(item.Content))
            {
                continue;
            }
            <div class="post-item-box">
                <div class="post-header-wrap">
                    <div class="user-photo">
                        <img src="~/Content/images/touxiang.png" class="tx-photo"/>
                    </div>
                    <div class="user-info">
                        <p>@item.UserName</p>
                        <p>@item.CreateDate.ToString("yyyy-MM-dd HH:mm")</p>
                    </div>
                </div>
                <div class="post-title">
                    @{
                        var linkText = string.IsNullOrEmpty(item.Title) ? (item.Content.Length <= 10 ? item.Content : item.Content.Substring(0, 10)) : item.Title;

                        if ((item.ReplyCount ?? 0) > 0)
                        {
                            linkText += " (" + item.ReplyCount + ")";
                        }
                    }
                    @Html.ActionLink(linkText, "Index", "ForumPost", new {id = item.Id}, null)
                </div>
                <div class="post-content">
                    @Html.Raw(item.Content)
                </div>
            </div>
        }
    }
</div>
